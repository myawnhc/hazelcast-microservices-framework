package com.theyawns.framework.security;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Nested;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.assertThatThrownBy;

/**
 * Tests for {@link SecurityProperties}.
 *
 * @author Generated by Claude Code
 * @since 3.0
 */
@DisplayName("SecurityProperties - Configuration property binding")
class SecurityPropertiesTest {

    @Nested
    @DisplayName("Default values")
    class DefaultValues {

        @Test
        @DisplayName("should be disabled by default")
        void shouldBeDisabledByDefault() {
            final SecurityProperties props = new SecurityProperties();
            assertThat(props.isEnabled()).isFalse();
        }

        @Test
        @DisplayName("should have default public paths containing actuator")
        void shouldHaveDefaultPublicPaths() {
            final SecurityProperties props = new SecurityProperties();
            assertThat(props.getPublicPaths()).containsExactly("/actuator/**");
        }
    }

    @Nested
    @DisplayName("Property setters")
    class PropertySetters {

        @Test
        @DisplayName("should set enabled to true")
        void shouldSetEnabled() {
            final SecurityProperties props = new SecurityProperties();
            props.setEnabled(true);
            assertThat(props.isEnabled()).isTrue();
        }

        @Test
        @DisplayName("should set custom public paths")
        void shouldSetPublicPaths() {
            final SecurityProperties props = new SecurityProperties();
            props.setPublicPaths(new String[]{"/health", "/info"});
            assertThat(props.getPublicPaths()).containsExactly("/health", "/info");
        }

        @Test
        @DisplayName("should accept empty public paths array")
        void shouldAcceptEmptyPublicPaths() {
            final SecurityProperties props = new SecurityProperties();
            props.setPublicPaths(new String[]{});
            assertThat(props.getPublicPaths()).isEmpty();
        }

        @Test
        @DisplayName("should reject null public paths")
        void shouldRejectNullPublicPaths() {
            final SecurityProperties props = new SecurityProperties();
            assertThatThrownBy(() -> props.setPublicPaths(null))
                    .isInstanceOf(NullPointerException.class)
                    .hasMessageContaining("publicPaths cannot be null");
        }
    }

    @Nested
    @DisplayName("toString")
    class ToStringTests {

        @Test
        @DisplayName("should include enabled status and public paths")
        void shouldIncludeAllFields() {
            final SecurityProperties props = new SecurityProperties();
            final String str = props.toString();
            assertThat(str).contains("enabled=false");
            assertThat(str).contains("publicPaths=");
            assertThat(str).contains("/actuator/**");
        }

        @Test
        @DisplayName("should reflect modified values")
        void shouldReflectModifiedValues() {
            final SecurityProperties props = new SecurityProperties();
            props.setEnabled(true);
            props.setPublicPaths(new String[]{"/health"});
            final String str = props.toString();
            assertThat(str).contains("enabled=true");
            assertThat(str).contains("/health");
        }
    }
}
