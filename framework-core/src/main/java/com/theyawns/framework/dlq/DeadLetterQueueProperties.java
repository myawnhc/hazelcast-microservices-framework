package com.theyawns.framework.dlq;

import org.springframework.boot.context.properties.ConfigurationProperties;

import java.time.Duration;

/**
 * Configuration properties for the dead letter queue.
 *
 * <p>Example configuration in application.yml:
 * <pre>{@code
 * framework:
 *   dlq:
 *     enabled: true
 *     map-name: framework_DLQ
 *     max-replay-attempts: 3
 *     entry-ttl: 168h
 * }</pre>
 *
 * @author Generated by Claude Code
 * @since 3.0
 * @see DeadLetterQueueAutoConfiguration
 */
@ConfigurationProperties(prefix = "framework.dlq")
public class DeadLetterQueueProperties {

    /**
     * Whether the dead letter queue is enabled.
     * Default: true
     */
    private boolean enabled = true;

    /**
     * IMap name for DLQ entries.
     * Default: framework_DLQ
     */
    private String mapName = "framework_DLQ";

    /**
     * Maximum number of replay attempts before permanent discard.
     * Default: 3
     */
    private int maxReplayAttempts = 3;

    /**
     * How long DLQ entries survive before eviction.
     * Default: 168 hours (7 days)
     */
    private Duration entryTtl = Duration.ofHours(168);

    /**
     * Creates a new DeadLetterQueueProperties with default values.
     */
    public DeadLetterQueueProperties() {
        // Default constructor
    }

    /**
     * Returns whether the dead letter queue is enabled.
     *
     * @return true if enabled
     */
    public boolean isEnabled() {
        return enabled;
    }

    /**
     * Sets whether the dead letter queue is enabled.
     *
     * @param enabled true to enable the DLQ
     */
    public void setEnabled(final boolean enabled) {
        this.enabled = enabled;
    }

    /**
     * Returns the IMap name for DLQ entries.
     *
     * @return the map name
     */
    public String getMapName() {
        return mapName;
    }

    /**
     * Sets the IMap name for DLQ entries.
     *
     * @param mapName the map name
     */
    public void setMapName(final String mapName) {
        this.mapName = mapName;
    }

    /**
     * Returns the maximum number of replay attempts.
     *
     * @return the max replay attempts
     */
    public int getMaxReplayAttempts() {
        return maxReplayAttempts;
    }

    /**
     * Sets the maximum number of replay attempts.
     *
     * @param maxReplayAttempts the max replay attempts (must be >= 1)
     */
    public void setMaxReplayAttempts(final int maxReplayAttempts) {
        if (maxReplayAttempts < 1) {
            throw new IllegalArgumentException(
                    "maxReplayAttempts must be at least 1, got: " + maxReplayAttempts);
        }
        this.maxReplayAttempts = maxReplayAttempts;
    }

    /**
     * Returns the entry TTL.
     *
     * @return the entry TTL
     */
    public Duration getEntryTtl() {
        return entryTtl;
    }

    /**
     * Sets the entry TTL.
     *
     * @param entryTtl the entry TTL
     */
    public void setEntryTtl(final Duration entryTtl) {
        this.entryTtl = entryTtl;
    }

    @Override
    public String toString() {
        return "DeadLetterQueueProperties{" +
                "enabled=" + enabled +
                ", mapName='" + mapName + '\'' +
                ", maxReplayAttempts=" + maxReplayAttempts +
                ", entryTtl=" + entryTtl +
                '}';
    }
}
