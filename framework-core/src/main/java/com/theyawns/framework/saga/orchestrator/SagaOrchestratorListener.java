package com.theyawns.framework.saga.orchestrator;

/**
 * Callback interface for observing saga orchestration lifecycle events.
 *
 * <p>All methods have default no-op implementations, so listeners can override
 * only the events they care about. This is useful for logging, metrics collection,
 * or triggering external notifications.
 *
 * <p>Example:
 * <pre>{@code
 * SagaOrchestratorListener metricsListener = new SagaOrchestratorListener() {
 *     @Override
 *     public void onSagaCompleted(String sagaId, SagaOrchestratorResult result) {
 *         meterRegistry.timer("saga.duration", "name", result.getSagaName())
 *             .record(result.getDuration());
 *     }
 * };
 * }</pre>
 *
 * @author Generated by Claude Code
 * @since 3.0
 * @see SagaOrchestrator
 */
public interface SagaOrchestratorListener {

    /**
     * Called when a saga begins execution.
     *
     * @param sagaId the saga instance ID
     * @param definition the saga definition being executed
     * @param context the initial saga context
     */
    default void onSagaStarted(final String sagaId, final SagaDefinition definition, final SagaContext context) {
        // no-op
    }

    /**
     * Called when a step begins execution.
     *
     * @param sagaId the saga instance ID
     * @param stepName the name of the step starting
     * @param stepIndex the zero-based index of the step
     */
    default void onStepStarted(final String sagaId, final String stepName, final int stepIndex) {
        // no-op
    }

    /**
     * Called when a step completes (success or failure).
     *
     * @param sagaId the saga instance ID
     * @param stepName the name of the completed step
     * @param result the step result
     */
    default void onStepCompleted(final String sagaId, final String stepName, final SagaStepResult result) {
        // no-op
    }

    /**
     * Called when compensation begins for a saga.
     *
     * @param sagaId the saga instance ID
     * @param failedStepName the step that triggered compensation
     * @param stepsToCompensate number of steps that need compensation
     */
    default void onCompensationStarted(final String sagaId, final String failedStepName,
                                       final int stepsToCompensate) {
        // no-op
    }

    /**
     * Called when a single compensation step completes.
     *
     * @param sagaId the saga instance ID
     * @param stepName the name of the step being compensated
     * @param result the compensation result
     */
    default void onCompensationStepCompleted(final String sagaId, final String stepName,
                                             final SagaStepResult result) {
        // no-op
    }

    /**
     * Called when the saga reaches a terminal state.
     *
     * @param sagaId the saga instance ID
     * @param result the final saga result
     */
    default void onSagaCompleted(final String sagaId, final SagaOrchestratorResult result) {
        // no-op
    }
}
