package com.theyawns.framework.persistence.postgres.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Id;
import jakarta.persistence.IdClass;
import jakarta.persistence.Table;
import org.hibernate.annotations.JdbcTypeCode;
import org.hibernate.type.SqlTypes;
import java.io.Serializable;
import java.time.OffsetDateTime;
import java.util.Objects;

/**
 * JPA entity for the {@code domain_views} table.
 *
 * <p>Uses a composite primary key of ({@code viewName}, {@code viewKey}).
 *
 * @author Generated by Claude Code
 * @since 3.0
 */
@Entity
@Table(name = "domain_views")
@IdClass(ViewStoreEntity.ViewStoreId.class)
public class ViewStoreEntity {

    @Id
    @Column(name = "view_name", length = 100, nullable = false)
    private String viewName;

    @Id
    @Column(name = "view_key", length = 255, nullable = false)
    private String viewKey;

    @Column(name = "view_data", nullable = false, columnDefinition = "jsonb")
    @JdbcTypeCode(SqlTypes.JSON)
    private String viewData;

    @Column(name = "last_updated_millis", nullable = false)
    private long lastUpdatedMillis;

    @Column(name = "created_at")
    private OffsetDateTime createdAt;

    @Column(name = "updated_at")
    private OffsetDateTime updatedAt;

    /**
     * Default constructor for JPA.
     */
    public ViewStoreEntity() {
    }

    /**
     * Full constructor.
     */
    public ViewStoreEntity(String viewName, String viewKey, String viewData,
                           long lastUpdatedMillis) {
        this.viewName = viewName;
        this.viewKey = viewKey;
        this.viewData = viewData;
        this.lastUpdatedMillis = lastUpdatedMillis;
    }

    public String getViewName() { return viewName; }
    public void setViewName(String viewName) { this.viewName = viewName; }

    public String getViewKey() { return viewKey; }
    public void setViewKey(String viewKey) { this.viewKey = viewKey; }

    public String getViewData() { return viewData; }
    public void setViewData(String viewData) { this.viewData = viewData; }

    public long getLastUpdatedMillis() { return lastUpdatedMillis; }
    public void setLastUpdatedMillis(long lastUpdatedMillis) { this.lastUpdatedMillis = lastUpdatedMillis; }

    public OffsetDateTime getCreatedAt() { return createdAt; }
    public void setCreatedAt(OffsetDateTime createdAt) { this.createdAt = createdAt; }

    public OffsetDateTime getUpdatedAt() { return updatedAt; }
    public void setUpdatedAt(OffsetDateTime updatedAt) { this.updatedAt = updatedAt; }

    /**
     * Composite primary key for domain_views.
     */
    public static class ViewStoreId implements Serializable {
        private static final long serialVersionUID = 1L;

        private String viewName;
        private String viewKey;

        public ViewStoreId() {}

        public ViewStoreId(String viewName, String viewKey) {
            this.viewName = viewName;
            this.viewKey = viewKey;
        }

        public String getViewName() { return viewName; }
        public void setViewName(String viewName) { this.viewName = viewName; }
        public String getViewKey() { return viewKey; }
        public void setViewKey(String viewKey) { this.viewKey = viewKey; }

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            ViewStoreId that = (ViewStoreId) o;
            return Objects.equals(viewName, that.viewName) && Objects.equals(viewKey, that.viewKey);
        }

        @Override
        public int hashCode() {
            return Objects.hash(viewName, viewKey);
        }
    }
}
