package com.theyawns.ecommerce.order.exception;

import com.theyawns.framework.resilience.NonRetryableException;

/**
 * Exception thrown when an order operation is invalid for the current state.
 *
 * <p>Implements {@link NonRetryableException} because an invalid order state is a
 * deterministic business failure that will not resolve on retry.
 *
 * @author Generated by Claude Code
 * @since 1.0
 */
public class InvalidOrderStateException extends RuntimeException implements NonRetryableException {

    private static final long serialVersionUID = 1L;

    private final String orderId;
    private final String currentStatus;
    private final String requestedOperation;

    /**
     * Creates a new InvalidOrderStateException.
     *
     * @param orderId the order ID
     * @param currentStatus the current order status
     * @param requestedOperation the operation that was attempted
     */
    public InvalidOrderStateException(String orderId, String currentStatus, String requestedOperation) {
        super(String.format("Cannot %s order %s: current status is %s",
                requestedOperation, orderId, currentStatus));
        this.orderId = orderId;
        this.currentStatus = currentStatus;
        this.requestedOperation = requestedOperation;
    }

    /**
     * Returns the order ID.
     *
     * @return the order ID
     */
    public String getOrderId() {
        return orderId;
    }

    /**
     * Returns the current status.
     *
     * @return the current status
     */
    public String getCurrentStatus() {
        return currentStatus;
    }

    /**
     * Returns the requested operation.
     *
     * @return the requested operation
     */
    public String getRequestedOperation() {
        return requestedOperation;
    }
}
