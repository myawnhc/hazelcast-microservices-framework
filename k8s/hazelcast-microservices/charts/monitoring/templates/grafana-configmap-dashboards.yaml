{{- if .Values.grafana.enabled -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "monitoring.fullname" . }}-grafana-dashboards
  labels:
    {{- include "monitoring.labels" . | nindent 4 }}
    app.kubernetes.io/component: grafana
data:
  {{- /* Dashboard JSON files are loaded from charts/monitoring/dashboards/ using .Files.Get.
         This avoids Helm trying to parse Grafana's curly-brace variable syntax as Go templates. */}}
  event-flow.json: |
{{ .Files.Get "dashboards/event-flow.json" | indent 4 }}
  materialized-views.json: |
{{ .Files.Get "dashboards/materialized-views.json" | indent 4 }}
  saga-dashboard.json: |
{{ .Files.Get "dashboards/saga-dashboard.json" | indent 4 }}
  system-overview.json: |
{{ .Files.Get "dashboards/system-overview.json" | indent 4 }}
{{- end }}
