# Global values shared across all subcharts
global:
  # Container image registry prefix (e.g., "myregistry.azurecr.io/" or "")
  imageRegistry: ""
  # Kubernetes storage class for PersistentVolumeClaims
  storageClass: ""
  # Hazelcast cluster name — must match across all services
  clusterName: "ecommerce-cluster"
  # Image pull secrets shared across all subcharts (for private registries like ECR)
  imagePullSecrets: []

# ----------------------------------------------
# Hazelcast Cluster (StatefulSet)
# ----------------------------------------------
# NOTE: These are the shared-cluster nodes for ITopic/saga state only.
# They do NOT run Jet pipelines — services run Jet on embedded instances.
# With IMap eviction enabled (maxSize=10000), memory is bounded.
hazelcast-cluster:
  enabled: true
  replicaCount: 2   # 2 nodes sufficient for local testing (saves ~512Mi)
  image:
    repository: hazelcast/hazelcast
    tag: "5.6.0"
    pullPolicy: IfNotPresent
  jvm:
    xms: "256m"
    xmx: "384m"     # 75% of 512Mi limit — leaves room for JVM overhead
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "512Mi"
      cpu: "1000m"

# ----------------------------------------------
# Account Service
# ----------------------------------------------
account-service:
  enabled: true
  replicaCount: 1
  image:
    repository: hazelcast-microservices/account-service
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    port: 8081
  persistence:
    enabled: false
  # autoscaling:
  #   enabled: true
  #   minReplicas: 2
  #   maxReplicas: 5
  # podDisruptionBudget:
  #   enabled: true
  jvm:
    xms: "256m"
    xmx: "512m"     # 67% of 768Mi limit
    opts: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
  resources:
    requests:
      memory: "384Mi"
      cpu: "250m"
    limits:
      memory: "768Mi"
      cpu: "1000m"

# ----------------------------------------------
# Inventory Service
# ----------------------------------------------
inventory-service:
  enabled: true
  replicaCount: 1
  image:
    repository: hazelcast-microservices/inventory-service
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    port: 8082
  persistence:
    enabled: false
  # autoscaling:
  #   enabled: true
  #   minReplicas: 2
  #   maxReplicas: 5
  # podDisruptionBudget:
  #   enabled: true
  jvm:
    xms: "256m"
    xmx: "512m"
    opts: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
  resources:
    requests:
      memory: "384Mi"
      cpu: "250m"
    limits:
      memory: "768Mi"
      cpu: "1000m"

# ----------------------------------------------
# Order Service
# ----------------------------------------------
order-service:
  enabled: true
  replicaCount: 1
  image:
    repository: hazelcast-microservices/order-service
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    port: 8083
  persistence:
    enabled: false
  # autoscaling:
  #   enabled: true
  #   minReplicas: 2
  #   maxReplicas: 5
  # podDisruptionBudget:
  #   enabled: true
  jvm:
    xms: "256m"
    xmx: "512m"
    opts: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
  resources:
    requests:
      memory: "384Mi"
      cpu: "250m"
    limits:
      memory: "768Mi"
      cpu: "1000m"

# ----------------------------------------------
# Payment Service
# ----------------------------------------------
payment-service:
  enabled: true
  replicaCount: 1
  image:
    repository: hazelcast-microservices/payment-service
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    port: 8084
  persistence:
    enabled: false
  # autoscaling:
  #   enabled: true
  #   minReplicas: 2
  #   maxReplicas: 5
  # podDisruptionBudget:
  #   enabled: true
  jvm:
    xms: "256m"
    xmx: "512m"
    opts: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
  resources:
    requests:
      memory: "384Mi"
      cpu: "250m"
    limits:
      memory: "768Mi"
      cpu: "1000m"

# ----------------------------------------------
# API Gateway
# ----------------------------------------------
api-gateway:
  enabled: true
  replicaCount: 1
  image:
    repository: hazelcast-microservices/api-gateway
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    port: 8080
  ingress:
    enabled: true
    className: ""
    annotations: {}
    hosts:
      - host: ""
        paths:
          - path: /
            pathType: Prefix
    tls: []
  # autoscaling:
  #   enabled: true
  #   minReplicas: 2
  #   maxReplicas: 5
  # podDisruptionBudget:
  #   enabled: true
  jvm:
    xms: "128m"
    xmx: "192m"     # 75% of 256Mi limit
    opts: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
  resources:
    requests:
      memory: "128Mi"
      cpu: "250m"
    limits:
      memory: "256Mi"
      cpu: "500m"

# ----------------------------------------------
# MCP Server
# ----------------------------------------------
mcp-server:
  enabled: false
  replicaCount: 1
  image:
    repository: hazelcast-microservices/mcp-server
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    port: 8085
  resources:
    requests:
      memory: "128Mi"
      cpu: "250m"
    limits:
      memory: "256Mi"
      cpu: "500m"

# ----------------------------------------------
# Monitoring (Prometheus + Grafana + Jaeger)
# ----------------------------------------------
monitoring:
  enabled: false
  prometheus:
    enabled: true
  grafana:
    enabled: true
    adminPassword: "admin"
  jaeger:
    enabled: true
