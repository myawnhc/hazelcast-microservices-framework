package com.theyawns.ecommerce.payment.exception;

import com.theyawns.framework.resilience.NonRetryableException;

/**
 * Exception thrown when a payment processor declines a payment attempt.
 *
 * <p>Common reasons include bad card numbers, insufficient funds, expired cards,
 * or fraud detection. These are deterministic failures that will not resolve on
 * retry, so this exception implements {@link NonRetryableException}.
 *
 * @author Generated by Claude Code
 * @since 3.0
 */
public class PaymentDeclinedException extends RuntimeException implements NonRetryableException {

    private static final long serialVersionUID = 1L;

    private final String orderId;
    private final String reason;
    private final String declineCode;

    /**
     * Creates a new PaymentDeclinedException.
     *
     * @param orderId the order ID for the declined payment
     * @param reason human-readable decline reason
     * @param declineCode processor-specific decline code (e.g., "card_declined", "insufficient_funds")
     */
    public PaymentDeclinedException(final String orderId, final String reason, final String declineCode) {
        super(String.format("Payment declined for order %s: %s (code: %s)", orderId, reason, declineCode));
        this.orderId = orderId;
        this.reason = reason;
        this.declineCode = declineCode;
    }

    /**
     * Returns the order ID for the declined payment.
     *
     * @return the order ID
     */
    public String getOrderId() {
        return orderId;
    }

    /**
     * Returns the human-readable decline reason.
     *
     * @return the decline reason
     */
    public String getReason() {
        return reason;
    }

    /**
     * Returns the processor-specific decline code.
     *
     * @return the decline code
     */
    public String getDeclineCode() {
        return declineCode;
    }
}
