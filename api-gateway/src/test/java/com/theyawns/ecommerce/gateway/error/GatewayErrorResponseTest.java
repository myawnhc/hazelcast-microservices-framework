package com.theyawns.ecommerce.gateway.error;

import java.time.Instant;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

/**
 * Tests for {@link GatewayErrorResponse}.
 *
 * @author Generated by Claude Code
 * @since 1.0
 */
@DisplayName("GatewayErrorResponse - DTO construction")
class GatewayErrorResponseTest {

    @Test
    @DisplayName("should store all fields correctly")
    void shouldStoreAllFieldsCorrectly() {
        final GatewayErrorResponse response = new GatewayErrorResponse(
                503, "SERVICE_UNAVAILABLE", "Service down", "corr-123", "/api/customers");

        assertThat(response.getStatus()).isEqualTo(503);
        assertThat(response.getErrorCode()).isEqualTo("SERVICE_UNAVAILABLE");
        assertThat(response.getMessage()).isEqualTo("Service down");
        assertThat(response.getCorrelationId()).isEqualTo("corr-123");
        assertThat(response.getPath()).isEqualTo("/api/customers");
    }

    @Test
    @DisplayName("should set timestamp automatically")
    void shouldSetTimestampAutomatically() {
        final Instant before = Instant.now();
        final GatewayErrorResponse response = new GatewayErrorResponse(
                502, "BAD_GATEWAY", "Error", null, null);
        final Instant after = Instant.now();

        assertThat(response.getTimestamp())
                .isAfterOrEqualTo(before)
                .isBeforeOrEqualTo(after);
    }

    @Test
    @DisplayName("should allow null correlationId")
    void shouldAllowNullCorrelationId() {
        final GatewayErrorResponse response = new GatewayErrorResponse(
                502, "BAD_GATEWAY", "Error", null, "/api/orders");

        assertThat(response.getCorrelationId()).isNull();
    }

    @Test
    @DisplayName("should allow null path")
    void shouldAllowNullPath() {
        final GatewayErrorResponse response = new GatewayErrorResponse(
                502, "BAD_GATEWAY", "Error", "corr-456", null);

        assertThat(response.getPath()).isNull();
    }
}
